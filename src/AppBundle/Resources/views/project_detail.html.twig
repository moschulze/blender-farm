{% extends 'AppBundle::base.html.twig' %}

{% block body %}
    <h1>{{ project.name }} details</h1>
    <p><a href="{{ path('project_index') }}" class="btn btn-primary">Back to overview</a></p>
    <p>Status: {{ project.status }}</p>
    <p>Format: {{ project.format }}</p>
    <p>Engine: {{ project.engine }}</p>
    {% if project.status == constant('AppBundle\\Entity\\Project::STATUS_NEW') %}
    <form method="post" action="{{ path('project_queue') }}">
        <input type="hidden" name="id" value="{{ project.id }}">
        <input type="submit">
    </form>
    {% endif %}
    {% if project.status != constant('AppBundle\\Entity\\Project::STATUS_NEW') %}
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th class="col-md-1">#</th>
                        <th>Status</th>
                        <th>Runtime</th>
                        <th>Remaining</th>
                        <th>Progress</th>
                        <th>&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    {% for task in project.tasks %}
                        {% set background = '' %}
                        {% set showImage = false %}
                        {% if task.status == constant('AppBundle\\Entity\\Task::STATUS_FINISHED') %}
                            {% set background = 'success' %}
                            {% set showImage = true %}
                        {% elseif task.status == constant('AppBundle\\Entity\\Task::STATUS_RENDERING') %}
                            {% set background = 'info' %}
                        {% endif %}
                        <tr class="{{ background }}">
                            <td>{{ task.frameNumber }}</td>
                            <td>{{ task.status }}</td>
                            <td>{{ task.runtime }}s</td>
                            <td>{{ task.remaining }}s</td>
                            <td>{{ (task.progress * 100)|number_format(2) }}%</td>
                            <td>{% if showImage %}<a href="{{ path('task_image', {'id': task.id}) }}" target="_blank">Show image</a>{% else %}&nbsp;{% endif %}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
{% endblock %}